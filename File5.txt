new changes by Amir
new code by Amir
